// conf/templates/user_hpc_template.config
//
// TEMPLATE — USER-SPECIFIC HPC CONFIG

includeConfig 'base.config'
process {
  executor = 'slurm'
  queue    = 'batch'     // <-- change to your default queue/partition
  cpus     = 8
  memory   = '32 GB'
  time     = '12h'

  // GPU tasks – processes labeled with "gpu"
  withLabel: gpu {
    queue          = 'gpu'                 // <-- change if your cluster differs
    cpus           = 16
    memory         = '64 GB'
    time           = '24h'
    // Examples for different clusters:
    // clusterOptions = '--gpus=1'
    // clusterOptions = '--gres=gpu:1'
    // clusterOptions = '--gpus=1 --constraint=A100'
    clusterOptions = '--gpus=1'
    containerOptions = '--nv'
  }

  // High memory tasks – processes labeled with "bigmem"
  withLabel: bigmem {
    memory = '100 GB'
  }
}

// ===============================
//  STORAGE / SCRATCH SETTINGS
// ===============================

// Work directory: should be on a fast scratch filesystem if possible
workDir = "/scratch/$USER/nf_work"

// Optional: override default outdir
// params.outdir = "/scratch/$USER/evidence_results"

// ===============================
//  SINGULARITY / DOCKER
// ===============================

singularity {
  enabled    = true
  autoMounts = true
  // envWhitelist = 'CUDA_VISIBLE_DEVICES,NVIDIA_VISIBLE_DEVICES'
}

docker {
  enabled = false
}