{
    "model": {
        "d_hidden": 128,
        "n_layers": 3,
        "output_size": 30,

        "lru": {
            "d_latent": 64,
            "init_radius": [[0.8, 1.0], [0.8, 1.0], [0.8, 1.0], [0.0, 0.2]],
            "init_phase": [
                [-0.157079632679, 0.157079632679],
                [1.9373154697076667, 2.2514747350656665],
                [4.031710572094333, 4.345869837452334],
                [0.0, 6.28318530716]
            ],
            "init_mixing_ratio": [0.31, 0.31, 0.31, 0.07],
            "dropout": 0.0,
            "max_tree_depth": 16
        },

        "ffn_type": "glu",
        "ffn": {
            "units": 256,
            "bias": true,
            "dropout": 0.1,
            "activation_hidden": "swish",
            "activation_out": null
        },

        "hmm": {
            "heads": 1,
            "parallel_factor": 99,
            "use_reverse_strand": true,
            "compute_heads_sequentially": false,

            "embed": 32,
            "in_normalize": true,
            "in_activation": "softmax",
            "share_noncoding_params": false,
            "emitter_sigmoid_activation": false,

            "intron_state_chain": 1,
            "intron_chain_skips": false,
            "intron_chain_loop": false,
            "initial_exon_len": 250,
            "initial_intron_len": 20,
            "initial_ir_len": 1000,
            "train_transitioner": false
        }
    },

    "dataset": {
        "train_paths": [
            "path/to/data_*.tfrecords"
        ],
        "validation_paths": null,

        "batch_size": 32,
        "T": 9999,
        "input_size": 6,
        "output_size": 30,
        "repeat": true,
        "shuffle": true,
        "shuffle_buffer": 100
    },

    "trainer": {
        "epochs": 100,
        "train_steps": 100,
        "val_steps": 5,

        "lr": 1e-3,
        "lr_warmup": 0.1,
        "lr_warmup_target": 1e-2,
        "lr_warmup_start": 1e-7,
        "lr_decay": 0.1,
        "lr_log_decay": null,
        "lr_log_decay_velocity": 10.0,

        "loss_f1_factor": 2.0,

        "log_annotation_metrics": [{
            "fasta": "path/to/genome.fa",
            "reference": "path/to/reference_cds.gtf",
            "gffcompare": "path/to/gffcompare",
            "take_seqs": null,
            "B": 12,
            "T": 99990,
            "use_head": 0,
            "every_n_epochs": 20,
            "use": "VITERBI",
            "liberal": true,
            "N_token": "track",
            "repeats_input": "track",
            "save_best_key": "locus/F1"
        }]
    }
}